Извиняюсь, если местами говнокод :)  
  
by Dimonchik0036
